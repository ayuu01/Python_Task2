import sys
import mysql.connector

def find_cust_detail():
   try:
     connection = mysql.connector.connect(host="localhost", user="root", passwd="Ayuagr01", database="pythondb")
     cur = connection.cursor()
     cur.execute("select * from pythondb.customer")

     for i in cur:
        print(i)
   except Exception as e:
     print(e)



def find_user_detail():
   try:
           connection = mysql.connector.connect(host="localhost", user="root", passwd="Ayuagr01", database="pythondb")
           cur = connection.cursor()
           cur.execute("select * from pythondb.user")
           for i in cur:
              print(i)
   except Exception as e:
           print(e)



def find_detail():
   try:
     connection = mysql.connector.connect(host="localhost", user="root", passwd="Ayuagr01", database="pythondb")
     cur = connection.cursor()
     cur.execute("select custId, custName from customer")
     for i in cur:
        print(i)
   except Exception as e:
     print(e)



def user_attchedto_cust():
   try:
     connection = mysql.connector.connect(host="localhost", user="root", passwd="Ayuagr01", database="pythondb")
     cur = connection.cursor()
     cur.execute("select * from customer c join user u on c.custId = u.custId")
     for i in cur:
        print(i)
   except Exception as e:
     print(e)


def details_location():
   try:
     connection = mysql.connector.connect(host="localhost", user="root", passwd="Ayuagr01", database="pythondb")
     cur = connection.cursor()
     cur.execute("select  custName from customer where custLocation='Delhi'")
     for i in cur:
        print(i)
   except Exception as e:
     print(e)



def name_start_with_H():
   try:
     connection = mysql.connector.connect(host="localhost", user="root", passwd="Ayuagr01", database="pythondb")
     cur = connection.cursor()
     cur.execute(" select * from customer where custName like 'H%'")
     for i in cur:
        print(i)
   except Exception as e:
     print(e)

def user_sorting_order():
   try:
      connection = mysql.connector.connect(host="localhost", user="root", passwd="Ayuagr01", database="pythondb")
      cur = connection.cursor()
      cur.execute(" select * from customer where custName like 'H%'")
      for i in cur:
        print(i)
   except Exception as e:
        print(e)

def list_user():
    try:
       connection = mysql.connector.connect(host="localhost", user="root", passwd="Ayuagr01",database="pythondb")
       cur = connection.cursor()
       cur.execute(" select userId,userFirstName,userLastName,userMobile,userEmail,custName,custLocation from customer c join user u on c.custId = u.custId")
       for i in cur:
            print(i)
    except Exception as e:
            print(e)


def average_user_count():
    try:
       connection = mysql.connector.connect(host="localhost", user="root", passwd="Ayuagr01",database="pythondb")
       cur = connection.cursor()
       cur.execute(" select avg(*) from customer c join user u on c.custId = u.custId where  custLocation='Delhi'")
       for i in cur:
            print(i)
    except Exception as e:
            print(e)


def total_user_count():
    try:
       connection = mysql.connector.connect(host="localhost", user="root", passwd="Ayuagr01",database="pythondb")
       cur = connection.cursor()
       cur.execute(" select count(*) from customer c join user u on c.custId = u.custId where  custLocation='Delhi'")
       for i in cur:
            print(i)
    except Exception as e:
            print(e)


def menu():
   while True:
      print("------------------------------------------------------------------------------");
      print("1. List All the Customers Details");
      print("2. List All the Users Details");
      print("3. List All the Customers with following details - name and customer id");
      print("4. Find no of Users attached to a customer");
      print("5. List All the Customers whose location is 'Delhi'");
      print("6. List All the Customers whose name start with Alphabet 'H'");
      print("7. List All the Users in sorting order of user count (descending order)");
      print("8. List All the Users with their customer name and location");
      print("9. Find Average user count attached to Customer for location Delhi");
      print("10. Find Total user count attached to Customer for location Delhi");
      print("11. Exit.");

      choice=int(input("Enter Your Choice: "))
      if(choice ==1):
          find_cust_detail()
      elif(choice == 2):
          find_user_detail()
      elif(choice == 3):
          find_detail()
      elif (choice == 4):
          user_attchedto_cust()
      elif (choice == 5):
          details_location()
      elif (choice == 6):
          name_start_with_H()
      elif (choice == 7):
          user_sorting_order()
      elif (choice == 8):
          list_user()
      elif (choice == 9):
          average_user_count()
      elif (choice == 10):
          total_user_count()
      elif (choice == 11):
          sys.exit()
      else:
          print("Wrong Choice")


menu()



